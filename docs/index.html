<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EtherCAT Control Framework: EtherCAT Control Software</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="symbol.webp"/></td>
  <td id="projectalign">
   <div id="projectname">EtherCAT Control Framework<span id="projectnumber">&#160;v0.9</span>
   </div>
   <div id="projectbrief">Implementation of EtherCAT protocol using IgH EtherCAT library for robot controller.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">EtherCAT Control Software </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="anchor" id="md_README"></a> Welcome to EtherCAT user space application by Veysi ADIN &amp; Chunwoo Kim.This repository contains EtherCAT based control software using CoE and CiA402 standard to control motors and receive sensor data, by wrapping IgH EtherCAT library functions. This implementation can be used with any robotic systems supporting EtherCAT protocol with small modifications. It contains EtherCAT real-time thread with priority of 98. And USB communication with Xbox <a class="el" href="structController.html" title="Xbox Controller values.">Controller</a>. You can use different type of user input device as well with small modifications.</p>
<p >Please check prerequisites, guides, links and documentations before installation, or using this control software. To be able to build this control software you will need to install IgH EtherCAT library, and if you need real-time performance you will need to install RT_PREEMPTH patch or Xenomai kernel. You can follow links below for the installation of required library and RT_PREEMPT installation.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Prerequisites</h1>
<ul>
<li><a href="https://github.com/veysiadn/IgHEtherCATImplementation">RT_Preempt Linux and IgH EtherCAT Implementation</a></li>
<li>If you want to use <a href="https://github.com/veysiadn/xenomai-install">Xenomai-Installation</a></li>
</ul>
<p >Once you install the prerequisites you're ready to build the control software.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Implementation</h1>
<div class="fragment"><div class="line">mkdir project-ws </div>
<div class="line">cd project-ws</div>
<div class="line">git clone https://github.com/veysiadn/ecat_userspace ethercat-control</div>
<div class="line">cd ethercat-control</div>
<div class="line">cmake .</div>
<div class="line">make</div>
</div><!-- fragment --><p> If there is no error during the compilation process you are ready to run the executable. </p><div class="fragment"><div class="line">sudo ./ecat_node</div>
</div><!-- fragment --><p> If it is running your implementation is succesful, and now you are ready to customize the software based on your application. By default number of connected slaves are defined as one, therefore if you don't have any slave to connect to your Ethernet port software will raise an error about the situation, but don't worry you can customize the software based on your needs.</p>
<h1><a class="anchor" id="autotoc_md3"></a>
Getting Started</h1>
<h2><a class="anchor" id="autotoc_md4"></a>
STEP 1 :</h2>
<p >You should start your customization from <a class="el" href="ecat__globals_8hpp.html">ecat_globals.hpp</a> file. In that file you can specify :</p><ul>
<li>Number of connected slaves and servo drives,</li>
<li>Control operation mode : Velocity Mode, Position Mode, Torque Mode, Cyclic Synchronous Velocity,Position and Torque modes are supported.</li>
<li>Control Frequency</li>
<li>Enable/Disable Distributed Clock</li>
<li>Motors encoder resolution : note that if you are using different type of motors you might need to create different definitions for each motor.</li>
<li>Motor Gear Ratio : note that if you are using different type of motors you might need to create different definitions for each motor.</li>
<li>Custom Slave : If you have different slave than the CiA402 supported servo drive you will need to define custom slave and PDO mapping for that custom slave.</li>
<li>Keep in mind that this software addresses connected slaves based on physical position. For example the 0th slave will be the first slave that is connected to your Ethernet port.</li>
<li>Custom slave must be in the end of slave chain.</li>
<li></li>
</ul>
<h2><a class="anchor" id="autotoc_md5"></a>
STEP 2 :</h2>
<p >Once you did your initial configuration in the <a class="el" href="ecat__globals_8hpp.html">ecat_globals.hpp</a> file. You can modify user input method in <a class="el" href="main_8cpp.html">main.cpp</a> file.</p><ul>
<li>Currently this software uses <a class="el" href="classXboxController.html">XboxController</a> left and right axis to send control commands the connected motors, if you want to use different input you can remove Xbox related control parameters and add your own.</li>
<li>If you want to use Xbox <a class="el" href="structController.html" title="Xbox Controller values.">Controller</a> for testing keep in mind that each axis in controller generated data in the range of -32768 ~ 32768.</li>
</ul>
<h2><a class="anchor" id="autotoc_md6"></a>
STEP 3 :</h2>
<ul>
<li>Change configuration parameters for your motor in <a class="el" href="ecat__node_8cpp.html">ecat_node.cpp</a> file based on your operation mode. For example if you want to use velocity mode you can change parameters in the SetProfileVelocityParametersAll(ProfileVelocityParam&amp; P) function based on your needs.</li>
<li>Change control parameters based on your selected operation mode in <a class="el" href="ecat__lifecycle_8cpp.html">ecat_lifecycle.cpp</a> file in the Update functions. For example if you want to use velocity mode in your control loop, you can change function content of UpdateVelocityModeParameters();</li>
</ul>
<p >Once you did those changes you will need recompile the software using make and you can test the executable.</p>
<h2><a class="anchor" id="autotoc_md7"></a>
NOTE</h2>
<ul>
<li>This software heavily tested on Maxon EPOS drivers, therefore if you want to use different servo driver you will need to check PDO mapping of your slave, or you can do custom PDO mapping by using MapCustomPdo function defined in <a class="el" href="ecat__node_8cpp.html">ecat_node.cpp</a> file. </li>
</ul>
<h1><a class="anchor" id="autotoc_md8"></a>
Guides</h1>
<ul>
<li><a href="https://www.ethercat.org/en/technology.html">EtherCAT</a></li>
<li><a href="https://www.etherlab.org/en/ethercat/index.php">Etherlab Webpage</a></li>
<li><a href="https://www.etherlab.org/download/ethercat/ethercat-1.5.2.pdf">IgH EtherCAT Library Documentation</a></li>
<li><a href="https://wiki.linuxfoundation.org/realtime/documentation/technical_basics/start">Real-time Linux</a></li>
<li><a href="https://design.ros2.org/articles/realtime_background.html">Real-time Background</a></li>
<li><a href="https://www.ripublication.com/ijaer17/ijaerv12n21_94.pdf">Article on EtherCAT-RT PREEMPT- Xenomai</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md9"></a>
Good Luck ⚡</h1>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
